trigger:
- main

pool:
  name: 'webapppool'

stages:
- stage: SecurityScan
  displayName: 'OWASP Dependency Check'
  jobs:
  - job: DependencyCheck
    displayName: 'Security Scan'
    steps:
    
    - checkout: self

    - task: Docker@2
      displayName: 'OWASP Dependency Check'
      inputs:
        command: 'run'
        arguments: |
          --rm 
          --volume $(Build.SourcesDirectory):/src:ro
          --volume $(Agent.TempDirectory)/reports:/reports
          owasp/dependency-check:latest 
          --scan /. 
          --format ALL 
          --project "$(Build.Repository.Name)" 
          --out /reports
